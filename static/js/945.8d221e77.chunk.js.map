{"version":3,"file":"static/js/945.8d221e77.chunk.js","mappings":";6PACA,QAA+B,mCAA/B,EAA4E,2CCM5E,MAAMA,GAAmBC,EAAAA,EAAAA,wBAAuB,CAC9CC,QAAS,CAAC,gCAAiC,uBAAwB,0BAD5CD,EAEtBE,IAAiI,IAAhI,cAAEC,EAAa,UAAEC,EAAS,MAAEC,EAAK,SAAEC,EAAQ,UAAEC,EAAS,QAAEC,EAAO,gBAAEC,EAAe,WAAEC,EAAU,iBAAEC,KAAqBC,GAAOV,EAC5H,MAAOW,EAAeC,EAAMC,GAAaZ,GAElCa,EAAOC,GAAYC,IAAgBN,IACnCO,EAAcC,IAAmBC,EAAAA,EAAAA,UAAS,KACzCC,QAASC,GAAgBX,EAE3BU,EAAUhB,EACZiB,EACA,IACKA,KACCb,EACA,CACE,CACEc,MAAO,eACPC,KAAM,UACNC,QAASC,GAAQ,CACf,CACEC,SAAU,eACVC,SAAS,EACTC,QAASA,KACP,MAAMC,EAAkC,oBAAjBnB,EAAMoB,OAAwBpB,EAAMoB,OAAOL,GAAQA,EAAKf,EAAMoB,QACrFf,GAASD,IACP,MAAMiB,EAAWjB,EAAMkB,MAAM,GACvBC,EAAQF,EAASG,WAAUC,GAAmC,oBAAjBzB,EAAMoB,OAAwBpB,EAAMoB,OAAOK,GAAUA,EAAOzB,EAAMoB,UAAYD,IAIjI,OAHII,GAAS,GACXF,EAASK,OAAOH,EAAO,GAElBF,CAAQ,IAEjBb,GAAgBmB,IACd,MAAMC,EAAUD,EAAKL,MAAM,GACrBC,EAAQK,EAAQC,QAAQV,GAI9B,OAHII,GAAS,GACXK,EAAQF,OAAOH,EAAO,GAEjBK,CAAO,GACd,MAMZ,KAGJ,QAAEE,GAAYC,EAAAA,IAAIC,SACxB,OACEC,EAAAA,EAAAA,MAAA,OAAKzC,UAAW0C,IAAW1C,EAAW2C,GAAuBnB,SAAA,CAC1DpB,GAAWC,GACVoC,EAAAA,EAAAA,MAACG,EAAAA,MAAK,CAAC5C,UAAW2C,EAAiBnB,SAAA,CAChCnB,IACCwC,EAAAA,EAAAA,KAACpC,EAAa,CACZY,KAAK,OACLyB,UAAQ,EACRC,KAAK,QACL7C,SAAUA,KAAcU,GAASA,EAAMoC,OAAS,GAAKjC,EAAaiC,OAAS,IAAO7C,GAAaY,EAAaiC,OAASpC,EAAMoC,OAAS7C,EACpIuB,QAASA,KACPb,GAASD,GACAA,EAAMkB,MAAM,GAAGmB,QAAO1B,IACoF,IAAxGR,EAAasB,QAAgC,oBAAjB7B,EAAMoB,OAAwBpB,EAAMoB,OAAOL,GAAQA,EAAKf,EAAMoB,aAGrGZ,EAAgB,GAAG,EACnBQ,SACH,6BAIFpB,IACCyC,EAAAA,EAAAA,KAACK,EAAAA,OAAM,CACLC,MAAMN,EAAAA,EAAAA,KAACnC,EAAI,CAACW,KAAK,iBACjB0B,KAAK,QACL1B,KAAK,OACLnB,SAAUA,EACVwB,QAASA,KACPzB,GACEA,EAAMW,GAAOiB,IACX,GAAI1B,GAAa0B,EAASmB,OAAS7C,EAEjC,OADAmC,EAAQc,KAAK,2BAAOjD,wBACb,EAETU,EAASgB,EAAS,GAClB,EACJL,SACH,oBAKH,MACJqB,EAAAA,EAAAA,KAAClC,EAAS,CACR0C,eAAgB7C,EAAM6C,eACtBC,UAAW9C,EAAM8C,UACjBtD,UAAU,aACV+C,KAAK,QACLQ,YAAY,EACZ3B,OAAQpB,EAAMoB,OACdV,QAASA,EACTsC,WAAY5C,EACZ6C,cACGvD,GACDK,GAAoB,CAClBc,KAAM,WACNqC,gBAAiB3C,EACjB4C,SAAUxB,IACRnB,EAAgBmB,EAAK,OAKzB,IAIVxC,EAAiBiE,aAAe,CAC9BhD,MAAO,GACPgB,OAAQ,KACRxB,SAAS,EACTE,YAAY,EACZD,iBAAiB,EACjBE,kBAAkB,GAGpB,MAAMsD,GAAcjE,EAAAA,EAAAA,wBAAuB,CACzCC,QAAS,CAAC,mBADQD,EAEjBkE,IAAkC,IAAjC,cAAE/D,KAAkBS,GAAOsD,EAC7B,MAAOC,GAAShE,GACV,YAAEiE,GAAgBD,EAExB,OADeC,EAAYxD,EACpByD,CAAOtE,EAAiB,IAGjCkE,EAAYK,MAAQvE,EAEpB,2CCvIiBwE,EAAEC,EAAQ,MAASC,EAAEC,OAAOC,IAAI,iBAAiBC,EAAEF,OAAOC,IAAI,kBAAkBE,EAAEC,OAAOC,UAAUC,eAAeC,EAAEV,EAAEW,mDAAmDC,kBAAkBC,EAAE,CAACC,KAAI,EAAGC,KAAI,EAAGC,QAAO,EAAGC,UAAS,GAChP,SAASC,EAAEC,EAAEC,EAAEC,GAAG,IAAIC,EAAEC,EAAE,CAAC,EAAEC,EAAE,KAAKC,EAAE,KAAiF,IAAIH,UAAhF,IAASD,IAAIG,EAAE,GAAGH,QAAG,IAASD,EAAEN,MAAMU,EAAE,GAAGJ,EAAEN,UAAK,IAASM,EAAEL,MAAMU,EAAEL,EAAEL,KAAcK,EAAEd,EAAEoB,KAAKN,EAAEE,KAAKT,EAAEJ,eAAea,KAAKC,EAAED,GAAGF,EAAEE,IAAI,GAAGH,GAAGA,EAAE1B,aAAa,IAAI6B,KAAKF,EAAED,EAAE1B,kBAAe,IAAS8B,EAAED,KAAKC,EAAED,GAAGF,EAAEE,IAAI,MAAM,CAACK,SAASzB,EAAEhD,KAAKiE,EAAEL,IAAIU,EAAET,IAAIU,EAAEpF,MAAMkF,EAAEK,OAAOlB,EAAEmB,QAAQ,CAAoBC,EAAQC,IAAIb,EAAEY,EAAQE,KAAKd,8BCPxWe,EAAOH,QAAU,EAAjBG,oBCID,kBACA,aAEA,IAAIC,EAAS,CAAC,EAAEzB,eAEhB,SAAS0B,IAGR,IAFA,IAAIC,EAAU,GAELC,EAAI,EAAGA,EAAIC,UAAUzD,OAAQwD,IAAK,CAC1C,IAAIE,EAAMD,UAAUD,GAChBE,IACHH,EAAUI,EAAYJ,EAASK,EAAWF,IAE5C,CAEA,OAAOH,CACR,CAEA,SAASK,EAAYF,GACpB,GAAmB,kBAARA,GAAmC,kBAARA,EACrC,OAAOA,EAGR,GAAmB,kBAARA,EACV,MAAO,GAGR,GAAIG,MAAMC,QAAQJ,GACjB,OAAOJ,EAAWS,MAAM,KAAML,GAG/B,GAAIA,EAAIM,WAAatC,OAAOC,UAAUqC,WAAaN,EAAIM,SAASA,WAAWC,SAAS,iBACnF,OAAOP,EAAIM,WAGZ,IAAIT,EAAU,GAEd,IAAK,IAAItB,KAAOyB,EACXL,EAAOR,KAAKa,EAAKzB,IAAQyB,EAAIzB,KAChCsB,EAAUI,EAAYJ,EAAStB,IAIjC,OAAOsB,CACR,CAEA,SAASI,EAAa/F,EAAOsG,GAC5B,OAAKA,EAIDtG,EACIA,EAAQ,IAAMsG,EAGftG,EAAQsG,EAPPtG,CAQT,CAEqCwF,EAAOH,SAC3CK,EAAWa,QAAUb,EACrBF,EAAOH,QAAUK,QAKhB,KAFwB,EAAF,WACtB,OAAOA,CACP,UAFoB,OAEpB,YAIF,CArEA","sources":["webpack://@kne-components/components-field/./src/components/BatchSelect/style.module.scss?56f9","components/BatchSelect/index.js","../node_modules/react/cjs/react-jsx-runtime.production.min.js","../node_modules/react/jsx-runtime.js","../node_modules/classnames/index.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"batch-select\":\"style_batch-select__wivxh__5CHd6\",\"options\":\"style_options__z45Zd__5CHd6\"};","import useControlValue from '@kne/use-control-value';\nimport { createWithRemoteLoader } from '@kne/remote-loader';\nimport { App, Button, Space } from 'antd';\nimport classnames from 'classnames';\nimport { useState } from 'react';\nimport style from './style.module.scss';\n\nconst BatchSelectField = createWithRemoteLoader({\n  modules: ['components-core:ConfirmButton', 'components-core:Icon', 'components-core:Table']\n})(({ remoteModules, className, onAdd, disabled, minLength, showAdd, showBatchDelete, showDelete, showRowSelection, ...props }) => {\n  const [ConfirmButton, Icon, TablePage] = remoteModules;\n\n  const [value, setValue] = useControlValue(props);\n  const [selectedKeys, setSelectedKeys] = useState([]);\n  const { columns: baseColumns } = props;\n\n  const columns = disabled\n    ? baseColumns\n    : [\n        ...baseColumns,\n        ...(showDelete\n          ? [\n              {\n                title: '操作',\n                type: 'options',\n                valueOf: item => [\n                  {\n                    children: '删除',\n                    confirm: true,\n                    onClick: () => {\n                      const itemKey = typeof props.rowKey === 'function' ? props.rowKey(item) : item[props.rowKey];\n                      setValue(value => {\n                        const newValue = value.slice(0);\n                        const index = newValue.findIndex(target => (typeof props.rowKey === 'function' ? props.rowKey(target) : target[props.rowKey] === itemKey));\n                        if (index > -1) {\n                          newValue.splice(index, 1);\n                        }\n                        return newValue;\n                      });\n                      setSelectedKeys(keys => {\n                        const newKeys = keys.slice(0);\n                        const index = newKeys.indexOf(itemKey);\n                        if (index > -1) {\n                          newKeys.splice(index, 1);\n                        }\n                        return newKeys;\n                      });\n                    }\n                  }\n                ]\n              }\n            ]\n          : [])\n      ];\n\n  const { message } = App.useApp();\n  return (\n    <div className={classnames(className, style['batch-select'])}>\n      {showAdd || showBatchDelete ? (\n        <Space className={style['options']}>\n          {showBatchDelete && (\n            <ConfirmButton\n              type=\"text\"\n              isDelete\n              size=\"small\"\n              disabled={disabled || !(value && value.length > 0 && selectedKeys.length > 0) || (minLength && selectedKeys.length > value.length - minLength)}\n              onClick={() => {\n                setValue(value => {\n                  return value.slice(0).filter(item => {\n                    return selectedKeys.indexOf(typeof props.rowKey === 'function' ? props.rowKey(item) : item[props.rowKey]) === -1;\n                  });\n                });\n                setSelectedKeys([]);\n              }}\n            >\n              批量删除\n            </ConfirmButton>\n          )}\n          {showAdd && (\n            <Button\n              icon={<Icon type=\"icon-tianjia\" />}\n              size=\"small\"\n              type=\"text\"\n              disabled={disabled}\n              onClick={() => {\n                onAdd &&\n                  onAdd(value, newValue => {\n                    if (minLength && newValue.length < minLength) {\n                      message.info(`至少保留${minLength}条数据`);\n                      return false;\n                    }\n                    setValue(newValue);\n                  });\n              }}\n            >\n              添加\n            </Button>\n          )}\n        </Space>\n      ) : null}\n      <TablePage\n        controllerOpen={props.controllerOpen}\n        featureId={props.featureId}\n        className=\"table-page\"\n        size=\"small\"\n        pagination={false}\n        rowKey={props.rowKey}\n        columns={columns}\n        dataSource={value}\n        rowSelection={\n          !disabled &&\n          showRowSelection && {\n            type: 'checkbox',\n            selectedRowKeys: selectedKeys,\n            onChange: keys => {\n              setSelectedKeys(keys);\n            }\n          }\n        }\n      />\n    </div>\n  );\n});\n\nBatchSelectField.defaultProps = {\n  value: [],\n  rowKey: 'id',\n  showAdd: true,\n  showDelete: true,\n  showBatchDelete: true,\n  showRowSelection: true\n};\n\nconst BatchSelect = createWithRemoteLoader({\n  modules: ['FormInfo@hooks']\n})(({ remoteModules, ...props }) => {\n  const [hooks] = remoteModules;\n  const { useOnChange } = hooks;\n  const render = useOnChange(props);\n  return render(BatchSelectField);\n});\n\nBatchSelect.Field = BatchSelectField;\n\nexport default BatchSelect;\n","/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = '';\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (arg) {\n\t\t\t\tclasses = appendClass(classes, parseValue(arg));\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction parseValue (arg) {\n\t\tif (typeof arg === 'string' || typeof arg === 'number') {\n\t\t\treturn arg;\n\t\t}\n\n\t\tif (typeof arg !== 'object') {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (Array.isArray(arg)) {\n\t\t\treturn classNames.apply(null, arg);\n\t\t}\n\n\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\treturn arg.toString();\n\t\t}\n\n\t\tvar classes = '';\n\n\t\tfor (var key in arg) {\n\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\tclasses = appendClass(classes, key);\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction appendClass (value, newClass) {\n\t\tif (!newClass) {\n\t\t\treturn value;\n\t\t}\n\t\n\t\tif (value) {\n\t\t\treturn value + ' ' + newClass;\n\t\t}\n\t\n\t\treturn value + newClass;\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n"],"names":["BatchSelectField","createWithRemoteLoader","modules","_ref","remoteModules","className","onAdd","disabled","minLength","showAdd","showBatchDelete","showDelete","showRowSelection","props","ConfirmButton","Icon","TablePage","value","setValue","useControlValue","selectedKeys","setSelectedKeys","useState","columns","baseColumns","title","type","valueOf","item","children","confirm","onClick","itemKey","rowKey","newValue","slice","index","findIndex","target","splice","keys","newKeys","indexOf","message","App","useApp","_jsxs","classnames","style","Space","_jsx","isDelete","size","length","filter","Button","icon","info","controllerOpen","featureId","pagination","dataSource","rowSelection","selectedRowKeys","onChange","defaultProps","BatchSelect","_ref2","hooks","useOnChange","render","Field","f","require","k","Symbol","for","l","m","Object","prototype","hasOwnProperty","n","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","p","key","ref","__self","__source","q","c","a","g","b","d","e","h","call","$$typeof","_owner","current","exports","jsx","jsxs","module","hasOwn","classNames","classes","i","arguments","arg","appendClass","parseValue","Array","isArray","apply","toString","includes","newClass","default"],"sourceRoot":""}