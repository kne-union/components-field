"use strict";(self.webpackChunk_kne_components_components_field=self.webpackChunk_kne_components_components_field||[]).push([[683],{3945:(e,n,t)=>{t.r(n),t.d(n,{default:()=>f});var o=t(8529),a=t.n(o),l=t(3050),c=t(5199),s=t(8139),r=t.n(s),i=t(3884);const d="style_batch-select__wivxh__5CHd6",m="style_options__z45Zd__5CHd6";var p=t(579);const u=(0,l.createWithRemoteLoader)({modules:["components-core:ConfirmButton","components-core:Icon","components-core:Table"]})((e=>{let{remoteModules:n,className:t,onAdd:o,disabled:l,minLength:s,showAdd:u,showBatchDelete:h,showDelete:f,showRowSelection:x,...y}=e;const[S,w,b]=n,[g,v]=a()(y),[k,_]=(0,i.useState)([]),{columns:C}=y,B=l?C:[...C,...f?[{title:"\u64cd\u4f5c",type:"options",valueOf:e=>[{children:"\u5220\u9664",confirm:!0,onClick:()=>{const n="function"===typeof y.rowKey?y.rowKey(e):e[y.rowKey];v((e=>{const t=e.slice(0),o=t.findIndex((e=>"function"===typeof y.rowKey?y.rowKey(e):e[y.rowKey]===n));return o>-1&&t.splice(o,1),t})),_((e=>{const t=e.slice(0),o=t.indexOf(n);return o>-1&&t.splice(o,1),t}))}}]}]:[]],{message:M}=c.App.useApp();return(0,p.jsxs)("div",{className:r()(t,d),children:[u||h?(0,p.jsxs)(c.Space,{className:m,children:[h&&(0,p.jsx)(S,{type:"text",isDelete:!0,size:"small",disabled:l||!(g&&g.length>0&&k.length>0)||s&&k.length>g.length-s,onClick:()=>{v((e=>e.slice(0).filter((e=>-1===k.indexOf("function"===typeof y.rowKey?y.rowKey(e):e[y.rowKey]))))),_([])},children:"\u6279\u91cf\u5220\u9664"}),u&&(0,p.jsx)(c.Button,{icon:(0,p.jsx)(w,{type:"icon-tianjia"}),size:"small",type:"text",disabled:l,onClick:()=>{o&&o(g,(e=>{if(s&&e.length<s)return M.info(`\u81f3\u5c11\u4fdd\u7559${s}\u6761\u6570\u636e`),!1;v(e)}))},children:"\u6dfb\u52a0"})]}):null,(0,p.jsx)(b,{controllerOpen:y.controllerOpen,featureId:y.featureId,className:"table-page",size:"small",pagination:!1,rowKey:y.rowKey,columns:B,dataSource:g,rowSelection:!l&&x&&{type:"checkbox",selectedRowKeys:k,onChange:e=>{_(e)}}})]})}));u.defaultProps={value:[],rowKey:"id",showAdd:!0,showDelete:!0,showBatchDelete:!0,showRowSelection:!0};const h=(0,l.createWithRemoteLoader)({modules:["FormInfo@hooks"]})((e=>{let{remoteModules:n,...t}=e;const[o]=n,{useOnChange:a}=o;return a(t)(u)}));h.Field=u;const f=h},7002:(e,n,t)=>{t.r(n),t.d(n,{default:()=>m});var o=t(3050),a=t(5199),l=t(3884),c=t(8139),s=t.n(c);const r="style_row-disabled__EFGvs__5CHd6";var i=t(579);const d=(0,o.createWithRemoteLoader)({modules:["Table@TablePage","ConfirmButton","Common@SearchInput"]})((0,l.forwardRef)(((e,n)=>{let{remoteModules:t,searchRender:o,defaultValue:c,labelKey:d,getCheckboxDisabled:m,...p}=e;const[u,h,f]=t,[x,y]=(0,l.useState)(c||[]),[S,w]=(0,l.useState)(0),b=(0,l.useRef)(null),g=(0,l.useRef)(null),[v,k]=(0,l.useState)("");(0,l.useEffect)((()=>{const e=b.current;w(e.clientHeight);const n=new ResizeObserver((()=>{w(e.clientHeight)}));return n.observe(e),()=>{n.unobserve(e)}}),[]);const _=e=>"function"===typeof p.rowKey?p.rowKey(e):e[p.rowKey];(0,l.useImperativeHandle)(n,(()=>({getValue:()=>x})),[x]);const C=e=>"function"===typeof m?m(e):e.disabled;return(0,i.jsxs)(a.Row,{wrap:!1,gutter:10,children:[(0,i.jsx)(a.Col,{span:18,children:(0,i.jsxs)(a.Space,{direction:"vertical",block:!0,size:S?8:0,children:[(0,i.jsx)("div",{ref:b,children:o&&o({value:x,setValue:y,getFetchApi:()=>g.current})}),(0,i.jsx)(u,{...p,ref:g,controllerOpen:!1,scroll:{y:`calc(var(--modal-height) - 152px - ${S?S+8:0}px)`},rowClassName:e=>s()({[r]:C(e)}),rowSelection:{selectedRowKeys:x.map(_),getCheckboxProps:e=>({disabled:C(e)}),renderCell:(e,n)=>{const t=_(n);return(0,i.jsx)(a.Checkbox,{checked:e,disabled:C(n),onChange:()=>{y((o=>{const a=o.slice(0),l=a.findIndex((e=>_(e)===t));return e?l>-1&&a.splice(l,1):l>-1?a.splice(l,1,n):a.push(n),a}))}})},onSelectAll:(e,n,t)=>{y((n=>e?n.concat(t):n.filter((e=>-1===t.findIndex((n=>_(n)===_(e)))))))}}})]})}),(0,i.jsx)(a.Col,{span:6,children:(0,i.jsxs)(a.Space,{direction:"vertical",block:!0,children:[(0,i.jsxs)(a.Row,{justify:"space-between",children:[(0,i.jsxs)(a.Col,{children:["\u5df2\u9009:",x&&x.length>0?`(${x.length})`:""]}),(0,i.jsx)(a.Col,{children:(0,i.jsx)(h,{isDelete:!0,type:"text",size:"small",disabled:!(x&&x.length>0),onClick:()=>{y([])},children:"\u5168\u90e8\u79fb\u9664"})})]}),(0,i.jsx)(f,{value:v,placeholder:"\u641c\u7d22",onSearch:e=>{k(e)}}),(0,i.jsx)(a.Space,{wrap:!0,children:x.filter((e=>!v||("function"===typeof d?d(e):e[d]).indexOf(v)>-1)).map((e=>(0,i.jsx)(a.Tag,{closable:!0,onClose:()=>{y((n=>{const t=n.slice(0),o=t.indexOf(e);return o>-1&&t.splice(o,1),t}))},children:"function"===typeof d?d(e):e[d]},"function"===typeof p.rowKey?p.rowKey(e):e[p.rowKey])))})]})})]})})));d.defaultProps={rowKey:"id",labelKey:"name"};const m=(0,o.createWithRemoteLoader)({modules:["Modal@useModal"]})((e=>{let{remoteModules:n,children:t,...o}=e;const[a]=n,c=(0,l.useRef)(null),s=a();return t({modal:e=>{let{onConfirm:n,defaultValue:t,...a}=e;return s(Object.assign({},a,{children:(0,i.jsx)(d,{...o,defaultValue:t,ref:c}),onConfirm:()=>n&&n(c.current.getValue())}))}})}))},5683:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s,manifest:()=>r});var o=t(3945),a=t(3050),l=t(7002),c=t(3536);const s={BatchSelect:{name:"BatchSelect",summary:"<p>\u7528\u4e8e\u6279\u91cf\u9009\u62e9\u4e00\u4e9b\u5bf9\u8c61</p>",api:"<table>\n<thead>\n<tr>\n<th>\u5c5e\u6027\u540d</th>\n<th>\u8bf4\u660e</th>\n<th>\u7c7b\u578b</th>\n<th>\u9ed8\u8ba4\u503c</th>\n</tr>\n</thead>\n</table>",example:{isFull:!1,className:"BatchSelect_33795",style:"",list:[{title:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u6807\u9898",description:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u8bf4\u660e",code:"const { default: BatchSelect } = _BatchSelect;\nconst { createWithRemoteLoader } = remoteLoader;\nconst { default: SelectModal } = _SelectModal;\nconst { range } = lodash;\n\nconst BaseExample = createWithRemoteLoader({\n  modules: ['components-core:FormInfo@Form']\n})(({ remoteModules }) => {\n  const [Form] = remoteModules;\n  return (\n    <Form>\n      <SelectModal\n        loader={() => {\n          return {\n            pageData: range(20).map(index => ({\n              id: index,\n              name: `\u5f20\u4e09${index}`,\n              position: `\u804c\u4f4d${index}`,\n              experience: `${index + 1}\u5e74`\n            })),\n            totalCount: 20\n          };\n        }}\n        columns={[\n          {\n            title: '\u59d3\u540d',\n            name: 'name',\n            type: 'user'\n          },\n          {\n            title: '\u804c\u4f4d',\n            name: 'position',\n            type: 'mainInfo',\n            hover: false,\n            primary: false\n          },\n          {\n            title: '\u5de5\u4f5c\u7ecf\u9a8c',\n            name: 'experience',\n            type: 'serialNumberShort'\n          }\n        ]}\n      >\n        {({ modal }) => {\n          return (\n            <BatchSelect\n              labelRender={({ label, value }) => {\n                return `${label}:${(value && value.length) || 0}\u4eba`;\n              }}\n              label=\"\u672c\u6b21\u9884\u63d0\u5019\u9009\u4eba\"\n              name=\"candidate\"\n              rule=\"REQ\"\n              minLength={1}\n              columns={[\n                {\n                  title: '\u5019\u9009\u4eba\u59d3\u540d',\n                  name: 'name',\n                  type: 'user'\n                },\n                {\n                  title: '\u804c\u4f4d',\n                  name: 'position',\n                  type: 'mainInfo',\n                  hover: false,\n                  primary: false\n                }\n              ]}\n              onAdd={(value, callback) => {\n                modal({\n                  title: '\u6dfb\u52a0\u5019\u9009\u4eba',\n                  defaultValue: value,\n                  onConfirm: value => {\n                    return callback(value);\n                  }\n                });\n              }}\n            />\n          );\n        }}\n      </SelectModal>\n    </Form>\n  );\n});\n\nrender(<BaseExample />);\n\n",scope:[{name:"_BatchSelect",packageName:"@components/BatchSelect",component:o},{name:"remoteLoader",packageName:"@kne/remote-loader",component:a},{name:"_SelectModal",packageName:"@components/SelectModal",component:l},{name:"lodash",packageName:"lodash",component:c}]},{title:"\u4e0d\u5c55\u793a\u65b0\u589e\u548c\u6279\u91cf\u5220\u9664\u6309\u94ae",description:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u8bf4\u660e",code:"const { default: BatchSelect } = _BatchSelect;\nconst { createWithRemoteLoader } = remoteLoader;\n\nconst initFormData = {\n  candidate: [\n    { id: '1', name: '\u5019\u9009\u4eba1', position: '\u804c\u4f4d1' },\n    { id: '2', name: '\u5019\u9009\u4eba2', position: '\u804c\u4f4d2' }\n  ]\n};\n\nconst BaseExample = createWithRemoteLoader({\n  modules: ['components-core:FormInfo@Form']\n})(({ remoteModules }) => {\n  const [Form] = remoteModules;\n  return (\n    <Form data={initFormData}>\n      <BatchSelect\n        labelRender={({ label, value }) => {\n          return `${label}:${(value && value.length) || 0}\u4eba`;\n        }}\n        label=\"\u672c\u6b21\u9884\u63d0\u5019\u9009\u4eba\"\n        name=\"candidate\"\n        rule=\"REQ\"\n        showBatchDelete={false}\n        showRowSelection={false}\n        showAdd={false}\n        minLength={1}\n        columns={[\n          {\n            title: '\u5019\u9009\u4eba\u59d3\u540d',\n            name: 'name',\n            type: 'user'\n          },\n          {\n            title: '\u804c\u4f4d',\n            name: 'position',\n            type: 'mainInfo',\n            hover: false,\n            primary: false\n          }\n        ]}\n      />\n    </Form>\n  );\n});\n\nrender(<BaseExample />);\n\n",scope:[{name:"_BatchSelect",packageName:"@components/BatchSelect",component:o},{name:"remoteLoader",packageName:"@kne/remote-loader",component:a},{name:"_SelectModal",packageName:"@components/SelectModal",component:l},{name:"lodash",packageName:"lodash",component:c}]}]}},SelectModal:{name:"SelectModal",summary:"<p>\u590d\u6742\u4fe1\u606f\u9009\u62e9\u5f39\u7a97</p>",api:"<table>\n<thead>\n<tr>\n<th>\u5c5e\u6027\u540d</th>\n<th>\u8bf4\u660e</th>\n<th>\u7c7b\u578b</th>\n<th>\u9ed8\u8ba4\u503c</th>\n</tr>\n</thead>\n</table>",example:{isFull:!1,className:"SelectModal_0a2f0",style:"",list:[{title:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u6807\u9898",description:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u8bf4\u660e",code:"const { default: SelectModal } = _SelectModal;\nconst { Button } = antd;\nconst { range } = lodash;\n\nconst BaseExample = () => {\n  return (\n    <SelectModal\n      loader={() => {\n        return {\n          pageData: range(28).map(index => ({\n            id: index,\n            name: `\u5f20\u4e09${index}`,\n            position: `\u804c\u4f4d${index}`,\n            experience: `${index + 1}\u5e74`,\n            disabled: index > 10\n          })),\n          totalCount: 28\n        };\n      }}\n      columns={[\n        {\n          title: '\u59d3\u540d',\n          name: 'name',\n          type: 'user'\n        },\n        {\n          title: '\u804c\u4f4d',\n          name: 'position',\n          type: 'mainInfo',\n          hover: false,\n          primary: false\n        },\n        {\n          title: '\u5de5\u4f5c\u7ecf\u9a8c',\n          name: 'experience',\n          type: 'serialNumberShort'\n        }\n      ]}\n      onChange={value => {\n        console.log(value);\n      }}\n    >\n      {({ modal }) => (\n        <Button\n          onClick={() => {\n            modal({\n              title: '\u8bf7\u9009\u62e9'\n            });\n          }}\n        >\n          \u70b9\u51fb\n        </Button>\n      )}\n    </SelectModal>\n  );\n};\n\nrender(<BaseExample />);\n\n",scope:[{name:"_SelectModal",packageName:"@components/SelectModal",component:l},{name:"antd",packageName:"antd",component:t(5199)},{name:"lodash",packageName:"lodash",component:c}]}]}}},r={name:"components-field",version:"0.1.3","open-version":!0,"public-url":"/components-field",modules:[{name:"BatchSelect",baseDir:"/home/runner/work/components-field/components-field/src/components/BatchSelect"},{name:"SelectModal",baseDir:"/home/runner/work/components-field/components-field/src/components/SelectModal"}]}}}]);
//# sourceMappingURL=683.34c3a824.chunk.js.map